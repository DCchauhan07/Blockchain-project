<%- include partials/header.ejs %>

<body style="background: #abbaab;  /* fallback for old browsers */
background: -webkit-linear-gradient(to right, #ffffff, #abbaab);  /* Chrome 10-25, Safari 5.1-6 */
background: linear-gradient(to right, #ffffff, #abbaab); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */">

<body onload="connectMetamask(),connectContract()">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.2.7-rc.0/web3.min.js"></script>
    <div class="container">
        <div class="row mt-5">
            <div class="col-md-6 offset-md-3">
                <div id="readArea" class="text-center">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/36/MetaMask_Fox.svg/1200px-MetaMask_Fox.svg.png" alt="MetaMask Logo" style="width: 100px; height: 100px;">
                    <h2 class="mt-3">Connected to MetaMask</h2>
                    <p id="contractArea">Status: Not connected to Contract</p>
                    <p id="userArea" class="mt-3 text-muted">Status: Not connected to MetaMask</p>
                </div>
            </div>
        </div>
    </div>

    <div id="productList" class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-4">
                <div class="card">
                    <img src="https://insanelygoodrecipes.com/wp-content/uploads/2023/06/Cappuccino-Coffee-in-a-White-Cup.jpg" class="card-img-top" alt="Product 1">
                    <div class="card-body">
                        <h5 class="card-title">Cappuccino</h5>
                        <p class="card-text">A classic coffee drink made with equal parts brewed coffee and steamed milk.the perfect balance of espresso, steamed milk and foam.</p>
                        <button onclick="depositContract()">Buy Now</button><br>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <img src="https://coffeeaffection.com/wp-content/uploads/2021/05/Chocolate-frappe-coffee_Elena-Veselova_shutterstock.jpg" class="card-img-top" alt="Product 2">
                    <div class="card-body">
                        <h5 class="card-title">Frappuccino</h5>
                        <p class="card-text">A Frappuccino is a trademarked blended coffee beverage.</p>
                        <button onclick="depositContract()">Buy Now</button><br>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <img src="https://bunners.ca/cdn/shop/files/IMG_7051BlackBGGothicRainbowCakeWhole_2048x2048.jpg?v=1698853616" class="card-img-top" alt="Product 3">
                    <div class="card-body">
                        <h5 class="card-title">Cake</h5>
                        <p class="card-text">A rainbow cake is a vibrant and visually stunning dessert.</p>
                        <button onclick="depositContract()">Buy Now</button><br>
                    </div>
                </div>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-md-4">
                <div class="card">
                    <img src="https://img.cake24x7.com/writable/apps/cake24x7/ProductGallery/5969/Mouth-Watering-Chocolate-Pastry---6-Pcs.jpg" class="card-img-top" alt="Product 4">
                    <div class="card-body">
                        <h5 class="card-title">Chocolate Pastry</h5>
                        <p class="card-text">A chocolate pastry is a delectable dessert that features a rich and indulgent chocolate flavor wrapped in a flaky, buttery pastry.</p>
                        <button onclick="depositContract()">Buy Now</button><br>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <img src="https://www.thespruceeats.com/thmb/aoQd_AmdGA2O1jHp5lCXrrZjfi4=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/how-to-make-masala-chai-tea-4134710-step-05-1-d3f31d2f583743459275556b2c33b806.jpg" class="card-img-top" alt="Product 5">
                    <div class="card-body">
                        <h5 class="card-title">Tea</h5>
                        <p class="card-text">Masala tea, also known as chai Indian beverage cherished for its aromatic blend of spices combined with rich black tea.</p>
                        <button onclick="depositContract()">Buy Now</button><br>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <img src="https://www.foodandwine.com/thmb/CCe2JUHfjCQ44L0YTbCu97ukUzA=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/Partners-Latte-FT-BLOG0523-09569880de524fe487831d95184495cc.jpg" class="card-img-top" alt="Product 6">
                    <div class="card-body">
                        <h5 class="card-title">Latte</h5>
                        <p class="card-text">A latte or caff√® latte is a milk coffee that is a made up of one or two shots of espresso, steamed milk and frothed milk on top.</p>
                        <button onclick="depositContract()">Buy Now</button><br>
                    </div>
                </div>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-md-4">
                <div class="card">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTdfZyNS4AfLRaybgzL_27NywMHtV3wdbvvvU0ap54PnA&s" class="card-img-top" alt="Product 7">
                    <div class="card-body">
                        <h5 class="card-title">Masala Tea</h5>
                        <p class="card-text">Masala tea, also known as chai, is a popular Indian beverage and blend of spices.</p>
                        <button onclick="depositContract()">Buy Now</button><br>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <img src="https://imgcdn.floweraura.com/cover%20image.png" class="card-img-top" alt="Product 8">
                    <div class="card-body">
                        <h5 class="card-title">Blackcurrant Pastry</h5>
                        <p class="card-text">A blackcurrant pastry is a delightful sweet treat that typically features a buttery, flaky pastry filled with a luscious blackcurrant filling.</p>
                        <button onclick="depositContract()">Buy Now</button><br>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <img src="https://p.turbosquid.com/ts-thumb/Q0/iYJeTc/sA/ferochercakeslice/jpg/1676077186/1920x1080/turn_fit_q99/b96ac39062bbb3aa80628839fdea9c5aabfad2fe/ferochercakeslice-1.jpg" class="card-img-top" alt="Product 9">
                    <div class="card-body">
                        <h5 class="card-title">Ferrero Rocher</h5>
                        <p class="card-text">Ferrero Rocher is a popular brand of chocolate confectionery that consists of a whole roasted hazelnut encased in a thin wafer shell filled with hazelnut cream.</p>
                        <button onclick="depositContract()">Buy Now</button><br>
                    </div>
                </div>
            </div>
            <ul id="dynamicList">
            </ul>
        </div>
    </div>
</body>
<script>
        
    let account;
    const connectMetamask = async () => {
        if(window.ethereum !== "underfined"){
            const accounts = await ethereum.request({method: "eth_requestAccounts"});
            account = accounts[0];
            document.getElementById("userArea").innerHTML = `User Account: ${account}`;
        }
    }
    const connectContract = async () => {
        const ABI =[
        
	{
		"inputs": [],
		"name": "deposit",
		"outputs": [],
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getAddress",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	}
]
        const Address = "0x234990A5254285B68B726c7cc2bda562AedC9b94"; 
        window.web3 = await new Web3(window.ethereum);
        window.contract = await new window.web3.eth.Contract(ABI, Address);
        document.getElementById("contractArea").innerHTML = "Connected to Contract"; 
    }
const depositContract = async () => {
        //const amount = document.getElementById("depositInput").value;
        await window.contract.methods.deposit().send({from: account, value: 1});
    }

</script>
</html>
